CREATE DATABASE ORG;
SHOW databases;
USE ORG;

CREATE TABLE Worker(
WORKER_ID INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
FIRST_NAME CHAR(25),
LAST_NAME CHAR(25),
SALARY INT(15),
JOINING_DATE DATETIME,
DEPARTMENT CHAR(25)
);

INSERT INTO Worker (WORKER_ID,FIRST_NAME,LAST_NAME,SALARY,JOINING_DATE,DEPARTMENT) VALUES
(001,'Akansha','Parshad',100000,'14-02-20 09.00.00','Developer'),
(002,'Deepak','Nishad',80000,'14-02-20 09.00.00','Developer'),
(003,'Menka','Shah',70000,'14-02-20 09.00.00','HR'),
(004,'Saurav','Verma',800000,'14-02-20 09.00.00','Admin'),
(005,'Arti','N/A',75000,'14-02-20 09.00.00','Accountant'),
(006,'Suarav','Upadhya',900000,'14-02-20 09.00.00','Admin'),
(007,'Akarsh','paliwal',900000,'14-02-20 09.00.00','Accountant'),
(008,'gaurav','Sandiyla',900000,'14-02-20 09.00.00','Accountant');

SELECT  FIRST_NAME, SALARY FROM WORKER;

CREATE TABLE Bonus(
WORKER_REF_ID INT,
Bonus_Amount INT (10),
BONUS_DATE DATETIME,
FOREIGN KEY (WORKER_REF_ID)
REFERENCES Worker (WORKER_ID)
 ON DELETE CASCADE
);

INSERT INTO Bonus 
(WORKER_REF_ID, BONUS_AMOUNT,BONUS_DATE) VALUES
(001,5000,'16-02-20'),
(002,3000,'16-02-20'),
(003,4000,'16-02-20'),
(001,4500,'16-02-20'),
(002,3500,'16-02-20');

CREATE TABLE Title (
WORKER_REF_ID INT,
WORKER_TITLE CHAR(25),
AFFECTED_FROM DATETIME,
FOREIGN KEY (WORKER_REF_ID)
REFERENCES Worker (WORKER_ID)
 ON DELETE CASCADE
);

INSERT INTO Title
    (WORKER_REF_ID , WORKER_TITLE, AFFECTED_FROM) VALUES
(001, 'Manager','2016-02-20 00:00:00'),
(002, 'Executive','2016-06-11 00:00:00'),  
(008, 'Executive','2016-06-11 00:00:00'),  
(005, 'Manager','2016-06-11 00:00:00'),
(004, 'Asst. Manager','2016-06-11 00:00:00'),  
(007, 'Executive','2016-06-11 00:00:00'),  
(006, 'Lead','2016-06-11 00:00:00'),    
(003, 'Lead','2016-06-11 00:00:00');  

SELECT * FROM WORKER;
SELECT FIRST_NAME FROM WORKER;
SELECT FIRST_NAME, SALARY FROM WORKER;

DROP DATABASE ORG;

SELECT 55+11;

SELECT ucase('DEEPAK');

SELECT * FROM Worker WHERE SALARY >80000;
SELECT * FROM Worker WHERE DEPARTMENT = 'HR';
SELECT * FROM Worker WHERE DEPARTMENT = 'HR'; 
SELECT * FROM Worker WHERE SALARY BETWEEN 80000 AND 300000;
-- reduce or statment
-- HR , ADMIN
SELECT * From Worker Where DEPARTMENT ='HR' OR DEPARTMENT ='ADMIN'  OR DEPARTMENT = 'ACOUNTANT';
-- BETTER WAY
SELECT *FROM Worker WHERE DEPARTMENT IN ('HR','ADMIN');
SELECT *FROM Worker WHERE DEPARTMENT  NOT IN ('HR','ADMIN');

-- wildcard

SELECT * FROM Worker where first_name Like '%sha%';
SELECT * FROM Worker where first_name Like '_k%';
-- sorting
SELECT * FROM Worker order by salary;

SELECT * FROM Worker order by salary DESC;

-- Distinct 
SELECT DISTINCT DEPARTMENT FROM WORKER;

-- GROUP BY

SELECT DEPARTMENT , COUNT(*) FROM WORKER GROUP BY DEPARTMENT;

-- MIN
SELECT DEPARTMENT , MIN(SALARY) FROM WORKER GROUP BY DEPARTMENT;

-- Max
SELECT DEPARTMENT , MAX(SALARY) FROM WORKER GROUP BY DEPARTMENT;


-- Sum
SELECT DEPARTMENT , SUM(SALARY) FROM WORKER GROUP BY DEPARTMENT;

-- Group by having
SELECT DEPARTMENT , COUNT( DEPARTMENT) FROM WORKER GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT);

-- Avg salary by per department
SELECT DEPARTMENT, AVG(SALARY) FROM WORKER GROUP BY DEPARTMENT;

-- MIN salary by per department
SELECT DEPARTMENT, MIN(SALARY) FROM WORKER GROUP BY DEPARTMENT;


























